<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PDF/å›¾ç‰‡æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿ</title>
  <style>
    body { 
      font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif; 
      margin: 0;
      padding: 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .card { 
      max-width: 720px; 
      margin: 0 auto; 
      padding: 32px; 
      background: white;
      border-radius: 16px; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
    }
    h1 { 
      font-size: 24px; 
      margin: 0 0 8px; 
      color: #1a1a2e;
    }
    .subtitle {
      color: #6b7280;
      font-size: 14px;
      margin-bottom: 24px;
    }
    .hint { 
      color: #6b7280; 
      margin-bottom: 16px; 
      padding: 12px;
      background: #f9fafb;
      border-radius: 8px;
      font-size: 14px;
    }
    .error { 
      color: #b91c1c; 
      background: #fef2f2;
    }
    .ok { 
      color: #16a34a; 
      background: #f0fdf4;
    }
    .row { margin-top: 16px; }
    .file-input-wrapper {
      border: 2px dashed #d1d5db;
      border-radius: 12px;
      padding: 32px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    .file-input-wrapper:hover {
      border-color: #667eea;
      background: #f5f3ff;
    }
    .file-input-wrapper input {
      display: none;
    }
    .file-label {
      color: #374151;
      font-size: 15px;
    }
    .file-label strong {
      color: #667eea;
    }
    
    /* æ¨¡å¼é€‰æ‹©æ ·å¼ */
    .mode-selector {
      display: flex;
      gap: 16px;
      margin-top: 20px;
    }
    .mode-option {
      flex: 1;
      position: relative;
    }
    .mode-option input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
      z-index: 2;
    }
    .mode-card {
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      background: #f9fafb;
    }
    .mode-option input[type="radio"]:checked + .mode-card {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }
    .mode-option:hover .mode-card {
      border-color: #667eea;
    }
    .mode-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }
    .mode-title {
      font-size: 16px;
      font-weight: 600;
      color: #1a1a2e;
      margin-bottom: 4px;
    }
    .mode-desc {
      font-size: 12px;
      color: #6b7280;
    }
    .mode-output {
      font-size: 11px;
      color: #667eea;
      margin-top: 8px;
      font-weight: 500;
    }
    
    button { 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff; 
      border: none; 
      padding: 12px 24px; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 15px;
      font-weight: 500;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    button:disabled { 
      background: #9ca3af; 
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .features {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #e5e7eb;
    }
    .feature {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      background: #f9fafb;
      border-radius: 8px;
    }
    .feature-icon {
      font-size: 20px;
    }
    .feature-text {
      color: #6b7280;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ“„ PDF/å›¾ç‰‡æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿ</h1>
    <p class="subtitle">æ”¯æŒæ–‡å­—è¯†åˆ«å’Œè¡¨æ ¼æå–ï¼Œçµæ´»è¾“å‡º Word æˆ– Excel æ–‡æ¡£</p>
    
    {% if ark_ok %}
      <div class="hint ok">âœ… è±†åŒ… API å·²é…ç½®ï¼Œå¯ç›´æ¥ä¸Šä¼ å¤„ç†ã€‚</div>
    {% else %}
      <div class="hint error">âŒ æœªæ£€æµ‹åˆ° API é…ç½®ã€‚è¯·åœ¨ç»ˆç«¯å…ˆè®¾ç½®ç¯å¢ƒå˜é‡ï¼š<code>export ARK_API_KEY=...; export ARK_BASE_URL=https://ark.cn-beijing.volces.com/api/v3</code><br><small>ï¼ˆé€šè¿‡ç«å±±å¼•æ“ Ark å¹³å°è®¿é—®è±†åŒ… Vision APIï¼‰</small></div>
    {% endif %}
    <div class="hint">å½“å‰å›¾ç‰‡æ¥æºæ¨¡å¼ï¼š<b>{{ source }}</b>ï¼ˆå¯é€šè¿‡ç¯å¢ƒå˜é‡ <code>ARK_SOURCE</code> è®¾ç½®ä¸º <code>both</code> / <code>embedded</code> / <code>page</code>ï¼‰</div>

    <form class="row" method="post" enctype="multipart/form-data" action="/upload">
      <div class="file-input-wrapper" onclick="document.getElementById('fileInput').click()">
        <input type="file" id="fileInput" name="files" accept="application/pdf,image/*" multiple />
        <p class="file-label">
          <strong>ç‚¹å‡»é€‰æ‹©</strong> æˆ–æ‹–æ”¾æ–‡ä»¶åˆ°è¿™é‡Œ<br>
          <small>æ”¯æŒ PDFã€PNGã€JPGã€JPEGã€BMPã€WebP</small>
        </p>
      </div>
      
      <!-- æ¨¡å¼é€‰æ‹© -->
      <div class="mode-selector">
        <label class="mode-option">
          <input type="radio" name="mode" value="text" checked />
          <div class="mode-card">
            <div class="mode-icon">ğŸ“</div>
            <div class="mode-title">æ–‡å­—è¯†åˆ«</div>
            <div class="mode-desc">è¯†åˆ«æ‰€æœ‰æ–‡å­—ï¼Œè‡ªåŠ¨åˆ†çº§æ ‡é¢˜</div>
            <div class="mode-output">è¾“å‡º â†’ Word æ–‡æ¡£</div>
          </div>
        </label>
        <label class="mode-option">
          <input type="radio" name="mode" value="table" />
          <div class="mode-card">
            <div class="mode-icon">ğŸ“Š</div>
            <div class="mode-title">è¡¨æ ¼æå–</div>
            <div class="mode-desc">æå–è¡¨æ ¼æ•°æ®ï¼Œä¿ç•™ç»“æ„</div>
            <div class="mode-output">è¾“å‡º â†’ Excel è¡¨æ ¼</div>
          </div>
        </label>
      </div>
      
      <div class="row">
        <button type="submit" {% if not ark_ok %}disabled{% endif %}>ğŸš€ å¼€å§‹å¤„ç†</button>
      </div>
    </form>

    <div class="features">
      <div class="feature">
        <div class="feature-icon">ğŸ”</div>
        <div class="feature-text">æ™ºèƒ½è¯†åˆ«å…¨éƒ¨å†…å®¹</div>
      </div>
      <div class="feature">
        <div class="feature-icon">ğŸ“‹</div>
        <div class="feature-text">å¿½ç•¥æ°´å°ç›–ç« å¹²æ‰°</div>
      </div>
      <div class="feature">
        <div class="feature-icon">ğŸ·ï¸</div>
        <div class="feature-text">è‡ªåŠ¨åˆ†çº§æ ‡é¢˜ç»“æ„</div>
      </div>
      <div class="feature">
        <div class="feature-icon">ğŸ“Š</div>
        <div class="feature-text">å®Œæ•´ä¿ç•™è¡¨æ ¼ç»“æ„</div>
      </div>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const wrapper = document.querySelector('.file-input-wrapper');
    const label = wrapper.querySelector('.file-label');
    
    fileInput.addEventListener('change', function() {
      if (this.files.length > 0) {
        const names = Array.from(this.files).map(f => f.name).join(', ');
        label.innerHTML = `<strong>å·²é€‰æ‹© ${this.files.length} ä¸ªæ–‡ä»¶</strong><br><small>${names}</small>`;
        wrapper.style.borderColor = '#16a34a';
        wrapper.style.background = '#f0fdf4';
      }
    });
  </script>
</body>
</html>
